-- Todo código sql

/* Deleta todas as tabelas */
DROP TABLE HORAS;
DROP TABLE TIPO_CONTATO;
DROP TABLE CONTATO;
DROP TABLE PASSAGEM;
DROP TABLE ROTAS;
DROP TABLE PESSOA_FUNCIONARIO;
DROP TABLE EMPRESA;
DROP TABLE PESSOA;



/* Cria tabela PESSOA */
CREATE TABLE PESSOA
(
	ID_pessoa INTEGER PRIMARY KEY,
	Nome VARCHAR[30],
	Identidade BIGINT,
	CPF BIGINT,
	Data_de_nascimento DATE,
	Nacionalidade VARCHAR[30]
);



/* Cria tabela EMPRESA */
CREATE TABLE EMPRESA 
(
	ID_empresa INTEGER PRIMARY KEY,	
	Nome VARCHAR[30],
	Horario_de_funcionamento VARCHAR[30],
	CEP INTEGER
);



/* Cria tabela PESSOA_FUNCIONARIO */
CREATE TABLE PESSOA_FUNCIONARIO
(
	ID_pessoa INTEGER,
	ID_empresa INTEGER,

	FOREIGN KEY (ID_pessoa)
	REFERENCES PESSOA (ID_pessoa),
	
	FOREIGN KEY (ID_empresa)
	REFERENCES EMPRESA (ID_empresa)
);



/* Cria tabela HORAS */
CREATE TABLE HORAS 
(
	ID_hora INTEGER PRIMARY KEY,
	hora VARCHAR[30]
); 


/* Cria tabela ROTAS */
CREATE TABLE ROTAS 
(
	ID_rota INTEGER PRIMARY KEY,
	ID_hora_saida INTEGER,
	ID_hora_chegada INTEGER,
	ID_rodoviaria_saida INTEGER,
	ID_rodoviaria_chegada INTEGER,
	

	FOREIGN KEY (ID_hora_saida) 
	REFERENCES HORAS (ID_hora),

	FOREIGN KEY (ID_hora_chegada)
	REFERENCES HORAS (ID_hora),

	FOREIGN KEY (ID_rodoviaria_chegada)
	REFERENCES EMPRESA (ID_empresa),

	FOREIGN KEY (ID_rodoviaria_saida)
	REFERENCES EMPRESA (ID_empresa)
);



/* Cria tabela PASSAGEM */
CREATE TABLE PASSAGEM 
(
	ID_passagem INTEGER PRIMARY KEY,
	ID_rota INTEGER,
	ID_empresa INTEGER,
	Data_compra VARCHAR[30],
	Data_viagem VARCHAR[30],
	preco float,
	ID_pessoa INTEGER,
	

	FOREIGN KEY (ID_rota)
	REFERENCES ROTAS (ID_rota),

	FOREIGN KEY (ID_empresa)
	REFERENCES EMPRESA (ID_empresa),

	FOREIGN KEY (ID_pessoa)
	REFERENCES PESSOA (ID_pessoa)
);



/* Cria tabela TIPO_CONTATO */
CREATE TABLE TIPO_CONTATO 
(
	ID_tipo_contato INTEGER PRIMARY KEY,
	tipo VARCHAR[30]
);



/* Cria tabela CONTATO */
CREATE TABLE CONTATO 
(
	ID_contato INTEGER,
	ID_tipo_usuario INTEGER,
	contato_registro VARCHAR[40],
	ID_tipo_de_contato INTEGER,
	
	
	FOREIGN KEY (ID_contato)
	REFERENCES PESSOA (ID_pessoa),

	FOREIGN KEY (ID_contato)
	REFERENCES EMPRESA (ID_empresa),

	FOREIGN KEY (ID_tipo_de_contato)
	REFERENCES TIPO_CONTATO (ID_tipo_contato)
);



/* Insere valores na tabela PESSOA */
INSERT INTO PESSOA (ID_PESSOA,NOME,IDENTIDADE,CPF,NACIONALIDADE,DATA_DE_NASCIMENTO) VALUES
(1,'Jorge Teixeira Coelho',3950847,1758095381,'Brasil','1989/01/14'),
(2,'Moisés Fernandes Silva',216671,4768964313,'Chile','1990/11/06'),
(3,'Rodrigo Ferreira da Silva',2766111,12589964525,'Brasil','1978/07/09'),
(4,'Ciro Ferreira',3950847,12356698745,'Brasil','1988/09/05'),
(5,'José Antônio da Silva',156554,15857798654,'Brasil','1991/03/01'),
(6,'Alberto Gomes Ferreira',133397,45688715698,'França','1990/05/22'),
(7,'José Pereira da Silva',3216549,13257743751,'Brasil','1968/05/15'),
(8,'Carlos Alberto Senzi',4562783,15897664201,'Brasil','1973/05/23'),
(9,'Antônio Giestas Pinheiro',3968754,13258846759,'Argentina','1992/01/07'),
(10,'Terezinha Venâncio Flores',3652879,45398764210,'Brasil','1957/12/20'),
(11,'Thais Oliveira Negris',1659335,89764464531,'Brasil','1974/07/11'),
(12,'Paulo José de Almeida',3639853,15689945756,'Portugal','1987/03/18'),
(13,'Ricardo Ramalho Ramos',3698641,489643154,'Brasil','1957/10/01'),
(14,'Josefa Borges Zucarato',3590253,01475426215,'Brasil','1995/10/15'),
(15,'William Matheus de Jesus Rekel',3482600,70758296920,'Brasil','1999/10/10'),
(16,'Felipe Bastos de Sá',3591266,14851523365,'Brasil','1990/01/15'),
(17,'Julia Menezes de Assis',3598203,70787563653,'Brasil','1996/04/12'),
(18,'Jordão Soares Araújo',3554798,01754726285,'Africa','1975/03/01'),
(19,'Maria Aparecida do Carmo',3459759,14897160658,'Brasil','1969/05/29'),
(20,'Pablo Roberto Garcia',3850472,01735760653,'Mexico','1988/09/22'),
(21,'Cecila Caraveo',3122478,01725760754,'Rússia','1995/01/27'),
(22,'Maryann Kissee',3712488,11722730755,'Canadá','1992/07/26'),
(23,'Susanne Holiman',3225499,63423753134,'Brasil','1974/07/11'),
(24,'Olene Stengel',3312477,19835012431,'Alemanha','1979/08/28'),
(25,'Clayton Mcdonalds',3512567,13205438801,'Inglaterra','1984/08/19'),
(26,'Rudolf Bohner',3444562,12255438800,'Brasil','1964/06/29'),
(27,'Florinda Holen',3612566,01555426215,'Brasil','1968/06/12'),
(28,'Grace Alessi',3332561,11253347755,'Argentina','1992/07/26'),
(29,'Danilo Keeth',3117562,55888715692,'Brasil','1997/10/02'),
(30,'Pansy Montoro',3837569,1482798653,'Brasil','1989/10/02');



/* Insere valores na tabela EMPRESA */
INSERT INTO EMPRESA (ID_EMPRESA,NOME,HORARIO_DE_FUNCIONAMENTO,CEP) VALUES
(1,'Terminal Rodoviário de Carapina Águia Branca','23 horas',29020255),
(2,'Terminal Rodoviária de Vitória Carlos Alberto V. Campos','23 horas',29103822),
(3,'Terminal Rodoviário de Vila Velha','7 às 22',29160042),
(4,'Terminal Rodoviário de Domingos Martins','24 horas',29165480),
(5,'Viação Águia Branca','24 horas',29166888),
(6,'Viação Gontijo','24 horas',29160500),
(7,'Viação Itapemirim','7 às 22',29548055),
(8,'Viação Planeta','24 horas',30475151),
(9,'Viação Kaissara','8 às 20 horas',29151643),
(10,'Viação Alvorada','24 horas',29150801),
(11,'Terminal Rodoviário de Guarapari','24 horas',29374805),
(12,'Terminal Rodoviário de Congonhas','24 horas',29356876),
(13,'Terminal Rodoviário de Resplendor','24 horas',29146864);



/* Insere valores na tabela PESSOA_FUNCIONARIO */
INSERT INTO PESSOA_FUNCIONARIO(ID_PESSOA,ID_EMPRESA) VALUES
(1,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(2,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(3,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(4,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(5,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(6,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1));



/* Insere valores na tabela HORAS */
INSERT INTO HORAS(ID_hora,hora) VALUES
(1,'04:00'),
(2,'04:30'),
(3,'05:00'),
(4,'05:30'),
(5,'06:00'),
(6,'06:30'), 
(7,'07:00'),
(8,'07:30'),
(9,'08:00'),
(10,'08:30'),
(11,'09:00'),
(12,'09:30'), 
(13,'10:00'),
(14,'10:30'),
(15,'11:00'),
(16,'11:30'),
(17,'12:00'),
(18,'12:30'), 
(19,'13:00'),
(20,'13:30'),
(21,'14:00'),
(22,'14:30'),
(23,'15:00'),
(24,'15:30'), 
(25,'16:00'),
(26,'16:30'),
(27,'17:00'),
(28,'17:30'),
(29,'18:00'),
(30,'18:30'), 
(31,'19:00'),
(32,'19:30'),
(33,'20:00'),
(34,'20:30'),
(35,'21:00'),
(36,'21:30'),
(37,'22:00'),
(38,'22:30'),
(39,'23:00'),
(40,'23:30'),
(41,'00:00');



/* Insere valores na tabela ROTAS */
INSERT INTO ROTAS (ID_ROTA,ID_HORA_CHEGADA,ID_HORA_SAIDA,ID_RODOVIARIA_SAIDA,ID_RODOVIARIA_CHEGADA) VALUES
(1,4,7,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(2,1,8,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(3,9,30,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(4,30,40,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(5,38,1,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(6,3,33,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(7,12,27,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(8,4,7,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(9,4,13,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(10,5,10,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(11,18,24,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(12,7,20,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(13,1,9,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(14,8,20,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1)),
(15,38,1,(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1));



/* Insere valores na tabela PASSAGEM */
INSERT INTO PASSAGEM (ID_PASSAGEM,ID_PESSOA,ID_ROTA,ID_EMPRESA,DATA_COMPRA,DATA_VIAGEM,PRECO) VALUES
(1,1,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'02/10/2017,20:56:53','05/11/2017',87.00),
(2,1,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'05/10/2017,15:15:01','01/11/2017',87.00),
(3,2,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'05/10/2017,19:01:50','02/11/2017',87.00),
(4,3,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'13/10/2017,08:55:49','02/11/2017',35.00),
(5,4,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'14/10/2017,12:00:30','14/12/2017',35.00),
(6,5,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'25/10/2017,13:10:20','15/11/2017',45.00),
(7,5,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'26/10/2017,21:58:11','15/11/2017',45.00),
(8,6,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'30/10/2017,23:58:11','17/11/2017',20.00),
(9,6,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'01/11/2017,21:58:11','30/11/2017',105.00),
(10,6,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'01/11/2017,21:58:11','15/11/2017',48.00),
(11,7,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'01/11/2017,21:59:11','15/11/2017',48.00),
(12,8,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'02/11/2017,00:58:11','21/12/2017',180.00),
(13,9,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'02/11/2017,21:58:11','05/11/2017',78.00),
(14,10,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'02/11/2017,22:58:11','15/11/2017',38.00),
(15,11,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'02/11/2017,22:59:11','18/12/2017',93.00),
(16,12,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'11/11/2017,22:59:11','08/01/2018',120.00),
(17,13,(SELECT ID_ROTA FROM ROTAS ORDER BY random() LIMIT 1),(SELECT ID_EMPRESA FROM EMPRESA ORDER BY random() LIMIT 1),'12/11/2017,13:59:11','08/12/2017',26.00);




 /* Insere valores na tabela TIPO_CONTATO */ 
INSERT INTO TIPO_CONTATO(ID_TIPO_CONTATO,TIPO) VALUES
(1,'Telefone'),
(2,'Email'),
(3,'Telefone Celular');




/* Insere valores na tabela CONTATO */
INSERT INTO CONTATO(ID_CONTATO,CONTATO_REGISTRO,ID_TIPO_DE_CONTATO,ID_TIPO_USUARIO) VALUES
(1,'(27)981376439',3,1),
(1,'jcoelho@live.com',2,1),
(2,'(27)33246505',1,1),
(2,'moises43@live.com',2,1),
(3,'(27)33450987',1,1),
(3,'rod.fv@yahoo.com',2,1),
(4,'(27)33246878',1,1),
(4,'cirox@hotmail.com',2,1),
(5,'(27)34547806',1,1),
(5,'jos99@live.com',2,1),
(6,'(27)87921004',3,1),
(6,'albert6@gmail.com',2,1),
(7,'(27)998887761',3,1),
(7,'jose_per4@gmail.com',2,1),
(8,'(27)33254879',1,1),
(8,'carlos_senzi@ifes.br',2,1),
(9,'(27)981657899',3,1),
(9,'antonio_gs@gmail.com',2,1),
(10,'(27)33214566',1,1),
(10,'tete@live.com',2,1),
(11,'(27)32334567',1,1),
(11,'thais_linda@gmail.com',2,1),
(12,'(27)998786166',3,1),
(12,'paulo_jos1@gmail.com',2,1),
(13,'(27)33645521',1,1),
(13,'ricard_r@gmail.com',2,1),
(1,'(27)40041010',1,2),
(2,'(27)30550279',2,2),
(3,'80072321',3,2),
(4,'33334444',1,2),
(5,'sac@aguiabranca.com.br',2,2),
(6,'sac@gontijo.com.br',2,2),
(7,'sac@itapemirim.com.br',2,2),
(8,'sac@planeta.com.br',2,2),
(9,'sac@kaissara.com.br',2,2),
(10,'sac@alvorada.com.br',2,2);






-- 9.1	CONSULTAS DAS TABELAS COM TODOS OS DADOS INSERIDOS (Todas) 
SELECT * from PESSOA;
SELECT * from EMPRESA;
SELECT * from PESSOA_FUNCIONARIO;
SELECT * from HORAS;
SELECT * from ROTAS;
SELECT * from PASSAGEM;
SELECT * from TIPO_CONTATO;
SELECT * from CONTATO;


-- 9.2	CONSULTAS DAS TABELAS COM FILTROS WHERE (Mínimo 4)
SELECT * from PESSOA where NACIONALIDADE != 'Brasil';
SELECT * from PASSAGEM where PRECO > 40.00;
SELECT * from ROTAS where ID_RODOVIARIA_SAIDA = 3; 
SELECT * from PASSAGEM where DATA_COMPRA >= '01/11/2017';


-- 9.3	CONSULTAS QUE USAM OPERADORES LÓGICOS, ARITMÉTICOS E CAMPOS RENOMEADOS (Mínimo 6)
SELECT ID_EMPRESA,NOME as "Viação" from EMPRESA where NOME like 'Viação_%';
SELECT * from PASSAGEM where PRECO < 45.00;
SELECT ID_PESSOA,NOME from PESSOA where NOME like 'T_%';
SELECT * from PASSAGEM where PRECO > 40.00 and DATA_COMPRA >= '01/11/2017';
SELECT ID_EMPRESA, NOME as "Rodoviaria" from EMPRESA where NOME like 'Terminal_%';
SELECT * from PASSAGEM where PRECO > 20.0 and PRECO < 80.00;


-- 9.4	CONSULTAS QUE USAM OPERADORES LIKE (Mínimo 4) 
SELECT * from PESSOA where NOME like 'J%';
SELECT ID_PESSOA,NOME,CPF from PESSOA where NOME like '%_o';
SELECT * from EMPRESA where NOME like '%a';
SELECT * from EMPRESA where NOME like 'Viação_%';


-- 9.5	ATUALIZAÇÃO E EXCLUSÃO DE DADOS (Mínimo 6)
UPDATE PASSAGEM SET PRECO = 90.0 where PRECO = 87.0;
SELECT * FROM PASSAGEM;

UPDATE CONTATO SET CONTATO_REGISTRO = '(27)981376499' where CONTATO_REGISTRO = '(27)981376439';
SELECT * FROM CONTATO;

UPDATE CONTATO SET CONTATO_REGISTRO = 'jcoelho@hotmail.com' where CONTATO_REGISTRO = 'jcoelho@live.com';
SELECT * FROM CONTATO;

DELETE FROM CONTATO where ID_CONTATO = 2 and ID_TIPO_USUARIO = 1;
SELECT * FROM CONTATO;

DELETE FROM PASSAGEM where ID_PESSOA = 5;
SELECT *FROM PASSAGEM;

DELETE FROM PESSOA_FUNCIONARIO where ID_PESSOA = 1;
SELECT * FROM PESSOA_FUNCIONARIO;



-- 9.6	CONSULTAS COM JUNÇÃO E ORDENAÇÃO (Mínimo 6)
SELECT CONTATO_REGISTRO, ID_CONTATO from CONTATO ORDER BY ID_CONTATO;
SELECT PESSOA.NOME, CONTATO.CONTATO_REGISTRO from CONTATO inner join PESSOA on(PESSOA.ID_PESSOA = CONTATO.ID_CONTATO);
SELECT ROTAS.ID_HORA_SAIDA, HORAS.HORA as HORARIO_DE_PARTIDA from ROTAS inner join HORAS on(ROTAS.ID_HORA_SAIDA = HORAS.ID_HORA) order by ID_HORA;
SELECT PESSOA.NOME, PASSAGEM.DATA_COMPRA, PASSAGEM.DATA_VIAGEM from PASSAGEM inner join PESSOA on(PESSOA.ID_PESSOA = PASSAGEM.ID_PESSOA);
SELECT PESSOA.NOME, EMPRESA.NOME as "TRABALHA_EM" from PESSOA_FUNCIONARIO inner join PESSOA on(PESSOA.ID_PESSOA = PESSOA_FUNCIONARIO.ID_PESSOA) inner join EMPRESA on(EMPRESA.ID_EMPRESA = PESSOA_FUNCIONARIO.ID_EMPRESA);



-- 9.7	CONSULTAS COM GROUP BY E FUNÇES DE AGRUPAMENTO (Mínimo 6)
SELECT ID_PASSAGEM, PRECO FROM PASSAGEM GROUP BY PRECO;
SELECT PESSOA.ID_PESSOA, PESSOA.NOME, PESSOA.NACIONALIDADE, PRECO FROM PESSOA INNER JOIN PASSAGEM ON PASSAGEM.ID_PESSOA = PESSOA.ID_PESSOA GROUP BY PRECO;
SELECT * FROM CONTATO GROUP BY ID_CONTATO ;
SELECT count(ID_HORA) as "QUANTIDADE_DE_VIAGENS", HORAS.HORA from HORAS inner join ROTAS on(ROTAS.ID_HORA_SAIDA = HORAS.ID_HORA) group by ID_HORA
SELECT ID_CONTATO, PESSOA.NOME, count(*) AS "QTD_DE_FORMAS_DE_CONTATO" from CONTATO inner join PESSOA on(PESSOA.ID_PESSOA = CONTATO.ID_CONTATO) group by ID_CONTATO, NOME;
SELECT PASSAGEM.ID_ROTA, PASSAGEM.DATA_VIAGEM, PASSAGEM.PRECO FROM PASSAGEM INNER JOIN ROTAS ON (ROTAS.ID_ROTA = PASSAGEM.ID_ROTA) GROUP BY DATA_VIAGEM;



-- 9.8	CONSULTAS COM LEFT E RIGHT JOIN (Mínimo 4)
SELECT PESSOA_FUNCIONARIO.ID_PESSOA AS "FUNCIONARIO", PESSOA.NOME, PESSOA_FUNCIONARIO.ID_EMPRESA FROM PESSOA_FUNCIONARIO LEFT JOIN PESSOA ON (PESSOA.ID_PESSOA = PESSOA_FUNCIONARIO.ID_PESSOA);
SELECT PASSAGEM.ID_PASSAGEM, PESSOA.NOME, PASSAGEM.PRECO FROM PESSOA LEFT JOIN PASSAGEM ON (PESSOA.ID_PESSOA = PASSAGEM.ID_PESSOA);
SELECT CONTATO.ID_CONTATO, CONTATO.CONTATO_REGISTRO, TIPO_CONTATO.TIPO FROM CONTATO LEFT JOIN TIPO_CONTATO ON (CONTATO.ID_TIPO_DE_CONTATO = TIPO_CONTATO.ID_TIPO_DE_CONTATO);
SELECT ROTAS.ID_ROTA, HORAS.HORA AS "Hora_saida" FROM ROTAS LEFT JOIN HORAS ON (ROTAS.ID_HORA_SAIDA = HORAS.ID_hora);



-- 9.9	CONSULTAS COM SELF JOIN E VIEW (Mínimo 6)
CREATE VIEW informacoes_das_empresas as SELECT NOME,HORARIO_DE_FUNCIONAMENTO,CEP from EMPRESA;
SELECT * from informacoes_das_empresas;

CREATE VIEW quadro_de_funcionarios as SELECT PESSOA.NOME,empresa.NOME as trabalha_em from PESSOA_FUNCIONARIO inner join PESSOA on (PESSOA.ID_PESSOA = PESSOA_FUNCIONARIO.ID_PESSOA) inner join EMPRESA on (EMPRESA.ID_EMPRESA = PESSOA_FUNCIONARIO.ID_EMPRESA);
SELECT * from quadro_de_funcionarios;

CREATE VIEW viagens_noturnas as SELECT ROTAS.ID_ROTA, HORAS.HORA from ROTAS inner join HORAS on (ROTAS.ID_HORA_SAIDA = HORAS.ID_HORA) and HORA >= '18:00';
SELECT * from viagens_noturnas;

SELECT HORAS1.*, HORAS2.* from HORAS as HORAS1 inner join HORAS as HORAS2 on(HORAS1.HORA > HORAS2.HORA) limit 10;

CREATE VIEW preco_passagens as SELECT PRECO from PASSAGEM;
SELECT * from preco_passagens;

CREATE VIEW Passagem_José as SELECT PESSOA.NOME, PASSAGEM.DATA_COMPRA from PASSAGEM inner join PESSOA on (PESSOA.ID_PESSOA = PASSAGEM.ID_PESSOA) inner join EMPRESA on (EMPRESA.ID_EMPRESA = PASSAGEM.ID_EMPRESA) where PESSOA.NOME like "José%";
SELECT * from Passagem_José;



-- 9.10	SUBCONSULTAS (Mínimo 3)
SELECT * FROM PESSOA WHERE PESSOA.ID_PESSOA IN (SELECT PESSOA_FUNCIONARIO.ID_PESSOA FROM PESSOA_FUNCIONARIO);
SELECT * FROM ROTAS WHERE ROTAS.ID_ROTA IN (SELECT PASSAGEM.ID_ROTA FROM PASSAGEM);
SELECT PESSOA.ID_PESSOA, PESSOA.NOME, PESSOA.CPF FROM PESSOA WHERE PESSOA.ID_PESSOA IN (SELECT PASSAGEM.ID_PESSOA FROM PASSAGEM);
